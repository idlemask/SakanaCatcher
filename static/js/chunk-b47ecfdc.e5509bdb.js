(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b47ecfdc"],{8194:function(t,e,i){"use strict";i.d(e,"d",(function(){return o})),i.d(e,"c",(function(){return a})),i.d(e,"b",(function(){return n})),i.d(e,"e",(function(){return l})),i.d(e,"f",(function(){return r})),i.d(e,"a",(function(){return c}));var s=i("b775");function o(t){return Object(s["a"])({url:"/user/list",method:"get",params:t})}function a(t){return Object(s["a"])({url:"/user/detail",method:"get",params:{id:t}})}function n(t){return Object(s["a"])({url:"/user/names",method:"get",params:t})}function l(t){return Object(s["a"])({url:"/user/register/admin",method:"post",data:t})}function r(t){return Object(s["a"])({url:"/user/update",method:"post",data:t})}function c(t){return Object(s["a"])({url:"/user/delete",method:"post",data:t})}},"91e0":function(t,e,i){"use strict";i("fc53")},b643:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"basic-box"},[i("div",{staticClass:"header"},[i("div",{staticClass:"left"},[i("el-image",{staticClass:"cover",staticStyle:{height:"300px"},attrs:{src:t.memberDetail.avatar}}),i("div",{staticStyle:{display:"flex","flex-direction":"column",width:"100%","flex-wrap":"wrap"}},t._l(t.memberMapFilter,(function(e,s){return i("div",{key:s,staticClass:"cell"},[i("div",{staticClass:"title"},[t._v(" "+t._s(e.title)+" : ")]),"position"!==e.key&&"org"!==e.key||t.memberDetail[e.key].length>0?i("div",{staticClass:"content"},[t._v(" "+t._s(t.memberDetail[e.key])+" ")]):t._e()])})),0)],1),i("div",{staticClass:"right"},[i("el-button",{attrs:{icon:"el-icon-edit",type:"primary"},on:{click:function(e){return t.handleUpdate()}}},[t._v("编辑")]),t.$store.getters.isAdmin?i("el-button",{attrs:{icon:"el-icon-edit",type:"danger",plain:""},on:{click:t.resetPassword}},[t._v("重置密码")]):t._e()],1)]),i("div",{staticClass:"summary"},[i("div",{staticClass:"summary-title"},[t._v(" 成员简介 : ")]),i("div",{staticClass:"summary-content"},[t._v(" "+t._s(t.memberDetail.intro)+" ")])]),i("el-dialog",{attrs:{title:"编辑成员信息",visible:t.editDialogFormVisible},on:{"update:visible":function(e){t.editDialogFormVisible=e}}},[i("el-form",{ref:"dataForm",staticStyle:{width:"80%","margin-left":"50px"},attrs:{"label-position":"left","label-width":"70px"}},[i("el-form-item",{attrs:{label:"姓名",prop:"username"}},[i("el-input",{model:{value:t.dialogTemp.username,callback:function(e){t.$set(t.dialogTemp,"username",e)},expression:"dialogTemp.username"}})],1),i("el-form-item",{attrs:{label:"班级",prop:"password"}},[i("el-input",{model:{value:t.dialogTemp.uclass,callback:function(e){t.$set(t.dialogTemp,"uclass",e)},expression:"dialogTemp.uclass"}})],1),i("el-form-item",{attrs:{label:"性别"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:t.dialogTemp.gender,callback:function(e){t.$set(t.dialogTemp,"gender",e)},expression:"dialogTemp.gender"}},t._l(t.genderOptions,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),i("el-form-item",{attrs:{label:"状态"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:t.dialogTemp.status,callback:function(e){t.$set(t.dialogTemp,"status",e)},expression:"dialogTemp.status"}},t._l(t.statusOptions,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t.$store.getters.isAdmin?i("el-form-item",[i("template",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center"},slot:"label"},[t._v(" 职位 "),i("span",{staticClass:"el-icon-circle-plus-outline text-primary",staticStyle:{"align-self":"flex-start"},on:{click:t.handleAddPosition}})]),null!=t.dialogTemp.positionList&&t.dialogTemp.positionList.length<=0?i("span",{staticClass:"text-info"},[t._v("点击左侧+号添加职位")]):t._e(),t._l(t.dialogTemp.positionList,(function(e,s){return i("el-tag",{key:s,staticStyle:{"margin-right":"10px"},attrs:{closable:"",type:"success"},on:{close:function(e){return t.deletePosition(s)}}},[t._v(t._s(e.name))])}))],2):t._e(),i("el-form-item",{attrs:{label:"简介"}},[i("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"Please input"},model:{value:t.dialogTemp.intro,callback:function(e){t.$set(t.dialogTemp,"intro",e)},expression:"dialogTemp.intro"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.editDialogFormVisible=!1}}},[t._v(" 取消 ")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updateData()}}},[t._v(" 确定 ")])],1)],1),i("el-dialog",{staticStyle:{width:"50%",margin:"0 auto"},attrs:{title:"重置密码确认",visible:t.resetDialogFormVisible},on:{"update:visible":function(e){t.resetDialogFormVisible=e}}},[i("div",{ref:"dataForm",staticClass:"text-danger",staticStyle:{width:"100%"}},[i("span",[i("i",{staticClass:"el-icon-warning-outline"}),t._v("请在重置密码前告知账号有关人员重置后密码")]),i("div",{staticClass:"content"},[i("br"),i("el-input",{attrs:{placeholder:"请输入重置后密码"},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}})],1)]),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.resetDialogFormVisible=!1}}},[t._v(" 取消 ")]),i("el-button",{attrs:{type:"danger"},on:{click:t.handleReset}},[t._v(" 确定 ")])],1)]),i("el-dialog",{attrs:{title:"添加职位",visible:t.positionDialogFormVisible},on:{"update:visible":function(e){t.positionDialogFormVisible=e}}},[i("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{"label-position":"left","label-width":"70px"}},[i("el-cascader",{attrs:{options:t.positionOptions},model:{value:t.positionTemp,callback:function(e){t.positionTemp=e},expression:"positionTemp"}})],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.positionDialogFormVisible=!1}}},[t._v(" 取消 ")]),i("el-button",{attrs:{type:"primary"},on:{click:t.addPosition}},[t._v(" 确定 ")])],1)],1)],1)},o=[],a=(i("4de4"),i("c740"),i("b0c0"),i("a434"),i("8194")),n=i("c24f"),l=i("cc5e"),r=i("5c96"),c={username:"MemberDetail",data:function(){return{genderOptions:["男","女"],statusOptions:["活跃","离队","退役"],positionOptions:null,isEditMode:!1,resetDialogFormVisible:!1,editDialogFormVisible:!1,positionDialogFormVisible:!1,newPassword:"",username:"肥宅俱乐部",memberDetail:{id:"@increment",gender:"@Gender_ch",username:"@first",password:"@string",uclass:"@Major@string(number,3)",org:"@Org",position:"@Position",status:"Status",img:""},dialogTemp:{importance:1,intro:"",title:"",type:"",status:"",password:"",positionList:[]},positionTemp:{},categoryList:[{value:"0",label:"禁用"},{value:"1",label:"启用"}],memberMap:[{key:"id",title:"学号"},{key:"username",title:"姓名"},{key:"gender",title:"性别"},{key:"uclass",title:"班级"},{key:"org",title:"社团"},{key:"position",title:"职位"},{key:"status",title:"状态"},{key:"intro",title:"简介"}]}},computed:{memberMapFilter:function(){return this.memberMap.filter((function(t){return"intro"!==t.key}))}},created:function(){var t=this;this.fetchInfo(),Object(l["b"])().then((function(e){t.positionOptions=e.data.items}))},methods:{setTagsViewTitle:function(){var t=this;console.log(this.username),this.$route.meta.title=this.username;var e=this.$store.getters.visitedViews[this.$store.getters.visitedViews.findIndex((function(e){return e.path===t.$route.path}))];null!=e&&(e.title=this.username)},setPageTitle:function(){document.title="".concat(this.username)},fetchInfo:function(){var t=this,e=this.$route.params&&this.$route.params.id;console.log(e),Object(a["c"])(e).then((function(e){var i=e.data.items;for(var s in i["org"]=[],i["position"]=[],i.roles)i.org+=i.roles[s].org.name+", ",i["position"]+=i.roles[s].org.name+i.roles[s].position+", ";i.roles.length>0&&(i["org"]=i["org"].substring(0,i.org.lastIndexOf(",")),i["position"]=i.position.substring(0,i.position.lastIndexOf(","))),t.username=e.data.items.username,t.setPageTitle(),t.setTagsViewTitle(),console.log(i),t.memberDetail=i}))},handleAddPosition:function(){this.positionDialogFormVisible=!0},addPosition:function(){var t=this;console.log(this.positionTemp),Object(l["a"])(this.positionTemp[1]).then((function(e){for(var i=0;i<t.dialogTemp.positionList.length;i++)if(t.dialogTemp.positionList[i].id===e.data.items.id)break;i>=t.dialogTemp.positionList.length?t.dialogTemp.positionList.push(e.data.items):Object(r["Message"])({message:"不能重复添加职位",type:"error",duration:1e3}),t.positionDialogFormVisible=!1}))},deletePosition:function(t){var e={positionList:this.dialogTemp.positionList};console.log(e),e.positionList.splice(t),this.dialogTemp=Object.assign(e,this.dialogTemp)},handleUpdate:function(){var t=this;for(var e in this.dialogTemp=Object.assign({},this.memberDetail),this.dialogTemp["positionList"]=[],this.memberDetail.roles)this.dialogTemp.positionList.push({name:this.memberDetail.roles[e].org.name+this.memberDetail.roles[e].position,id:this.memberDetail.roles[e].id});this.dialogStatus="update",this.editDialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},updateData:function(){var t=this,e=Object.assign({},this.dialogTemp);e.timestamp=+new Date(e.timestamp),Object(a["f"])(e).then((function(){t.editDialogFormVisible=!1,t.fetchInfo(),t.$notify({title:"Success",message:"Update Successfully",type:"success",duration:2e3})}))},resetPassword:function(){this.resetDialogFormVisible=!0},handleReset:function(){this.resetDialogFormVisible=!1,Object(n["k"])({id:this.memberDetail.id,password:this.newPassword})},destroyDialog:function(){this.editData={},this.isEditMode=!1}}},u=c,d=(i("91e0"),i("2877")),m=Object(d["a"])(u,s,o,!1,null,"14b8e5c3",null);e["default"]=m.exports},cc5e:function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"a",(function(){return a}));var s=i("b775");function o(){return Object(s["a"])({url:"/role/positionOptions",method:"get"})}function a(t){return Object(s["a"])({url:"/role/position/id/"+t,method:"get"})}},fc53:function(t,e,i){}}]);