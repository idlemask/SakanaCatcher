(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2afeb4ab"],{"07c3":function(t,e,s){"use strict";s("fcd0")},5539:function(t,e,s){"use strict";s.d(e,"f",(function(){return a})),s.d(e,"g",(function(){return n})),s.d(e,"e",(function(){return r})),s.d(e,"d",(function(){return c})),s.d(e,"c",(function(){return o})),s.d(e,"b",(function(){return u})),s.d(e,"a",(function(){return l}));var i=s("b775");function a(){return Object(i["a"])({url:"/inform/p2p/list",method:"get"})}function n(t){return Object(i["a"])({url:"/inform/unRead/list",method:"get",params:t})}function r(){return Object(i["a"])({url:"/inform/p2o/list",method:"get"})}function c(t){return Object(i["a"])({url:"/inform/group/history",method:"get",params:t})}function o(t){return Object(i["a"])({url:"/inform/group/info",method:"get",params:{name:t}})}function u(t){return Object(i["a"])({url:"/inform/group/all",method:"get",params:{id:t}})}function l(t){return Object(i["a"])({url:"/inform/group/p2o/check",method:"get",params:{oid:t}})}},bb09:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[s("div",{staticClass:"container"},[s("div",{staticClass:"container-box container-left"},[s("div",{staticClass:"text-primary",staticStyle:{padding:"10px","font-weight":"bold"}},[t._v("常用联系人")]),s("div",{staticClass:"people-list"},t._l(t.peopleHub,(function(e,i){return s("div",{key:i,staticStyle:{"flex-direction":"column"}},[s("div",{staticClass:"chat-item",on:{click:function(s){return t.toChat(e.type,e.name)}}},[s("div",{staticClass:"chat-item-left"},[s("el-avatar",{attrs:{size:70,src:null!=e.lastMessage?e.lastMessage.sender.avatar:"http://localhost:8080/1.jpg"}})],1),s("div",{staticClass:"chat-item-right text-info"},[s("el-badge",{staticClass:"chat-item-user-info",attrs:{hidden:e.unread<=0,value:e.unread}},["p2o"===e.type?s("div",{staticClass:"chat-item-user-name text-primary",staticStyle:{"font-size":"18px"}},[t._v(" "+t._s(e.name)+" ")]):null!=e.users&&e.users.length>1?s("div",{staticClass:"chat-item-user-name text-primary",staticStyle:{"font-size":"18px"}},[t._v(" "+t._s(e.users["0"].id===t.$store.getters.id?e.users["1"].name:e.users["0"].name)+" ")]):null!=e.users?s("div",{staticClass:"chat-item-user-name text-primary",staticStyle:{"font-size":"18px"}},[t._v(" "+t._s(e.users["0"].name)+" ")]):t._e(),s("div",{staticClass:"chat-item-user-org text-success",staticStyle:{"font-size":"15px"}},[t._v(" "+t._s("p2p"===e.type?"个人通知":"社团通知")+" ")])])],1)]),i<t.peopleHub.length-1?s("div",{staticClass:"chat-item-divider"}):t._e()])})),0)]),s("div",{staticClass:"container-right"},t._l(t.typeMap,(function(e,i){return s("div",{key:i,staticClass:"type-item"},[s("div",{staticClass:"container-box"},[s("div",{staticClass:"type-title text-primary"},[t._v(t._s(e.title))]),s("div",{staticClass:"chat-list"},t._l(t.chartList[e.key],(function(i,a){return s("el-badge",{key:a,staticClass:"item",attrs:{hidden:i.unread<=0,value:i.unread}},[s("div",{staticClass:"chat-item",on:{click:function(e){return t.toChat(i.type,i.name)}}},[s("div",{staticClass:"chat-item-left"},[s("el-avatar",{attrs:{size:70,src:i.lastMessage.sender.avatar}})],1),s("div",{staticClass:"chat-item-right text-info"},[s("div",{staticClass:"chat-item-user-info"},["p2o"===i.type?s("div",{staticClass:"chat-item-user-name text-primary",staticStyle:{"font-size":"18px"}},[t._v(" "+t._s(i.name)+" ")]):"p2p"===e.key&&null!=i.users&&i.users.length>1?s("div",{staticClass:"chat-item-user-name text-primary",staticStyle:{"font-size":"18px"}},[t._v(" "+t._s(i.users["0"].id===t.$store.getters.id?i.users["1"].name:i.users["0"].name)+" ")]):null!=i.users?s("div",{staticClass:"chat-item-user-name text-primary",staticStyle:{"font-size":"18px"}},[t._v(" "+t._s(i.users["0"].name)+" ")]):t._e()]),t._v(" "+t._s(i.lastMessage.sender.name+":"+i.lastMessage.content)+" ")])])])})),1),t.chartList[e.key].length>3?s("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center"}},[s("div",{staticStyle:{"font-size":"20px","font-weight":"bolder",color:"#7d7d7f"}},[t._v("· · ·")]),s("el-button",{attrs:{plain:"",round:""}},[t._v("查看更多")])],1):t._e()])])})),0)])])},a=[],n=(s("b0c0"),s("5539")),r={name:"InformIndex",filters:{},data:function(){return{id:this.$store.getters.id,maxNum:3,chartList:{p2p:[],p2o:[]},peopleHub:[],typeMap:[{title:"个人通知",key:"p2p"},{title:"社团通知",key:"p2o"}]}},computed:{listenWebsocket:function(){return this.$store.state.websocket.message}},watch:{listenWebsocket:function(t){var e=JSON.parse(t);if("new dialog"===e.message){var s=Object.assign({},JSON.parse(e.items));this.getList(),s.sender.id!==this.id&&this.$notify({title:s.sender.name,message:s.content.length>25?s.content.substring(0,25)+"...":s.content,type:"success",duration:4e3})}}},mounted:function(){this.getList()},methods:{toChat:function(t,e){var s=this;Object(n["d"])({page:0,limit:5,groupName:e}).then((function(){s.getList(),s.$router.push({path:"/inform/"+t+"/"+e+"/"+(new Date).getTime()})}))},getList:function(){var t=this;Object(n["f"])().then((function(e){t.chartList.p2p=[];for(var s=Object.assign([],e.data.items),i=0;i<t.maxNum&&i<s.length;i++)s[i].lastTime=new Date(s[i].lastTime).getTime(),t.chartList.p2p.push(s[i]);console.log(e)})),Object(n["e"])().then((function(e){t.chartList.p2o=[];for(var s=Object.assign([],e.data.items),i=0;i<t.maxNum&&i<s.length;i++)s[i].lastTime=new Date(s[i].lastTime).getTime(),t.chartList.p2o.push(s[i])})),Object(n["b"])(this.$store.getters.id).then((function(e){t.peopleHub=[];for(var s=Object.assign([],e.data.items),i=0;i<s.length;i++)s[i].lastTime=new Date(s[i].lastTime).getTime(),t.peopleHub.push(s[i])}))}}},c=r,o=(s("07c3"),s("2877")),u=Object(o["a"])(c,i,a,!1,null,"26a39994",null);e["default"]=u.exports},fcd0:function(t,e,s){}}]);